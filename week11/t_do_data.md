## ARTS

### Tip

## 批量请求海量数据

需求背景：

有一个外部系统对外提供api查询服务，现在我们想通过api接口一次把他存储的所有数据都存储到我们本地，我们本地存在所有需要查询的已知条件。

问题点：

api提供了单条和批量的查询接口。如果是单条获取的话，我们可能会在循环里每一次遍历都会请求一次外部接口，对外部服务器造成压力，也有可能造成程序卡死拿不到数据的情况；批量查询最多支持一次请求200条数据，因为是批量数据有可能会导致取到的数据不能及时保存，线程卡死的情况；

实现思路：

采用批量查询的方式，首先一次性把我的已知条件组装起来，然后对我们的已知条件进行分组处理（每200个条件进行一次请求），然后在每一次请求完毕后等待程序的执行结果完成后再进行下一组的批量查询，减少两个系统的请求次数。



